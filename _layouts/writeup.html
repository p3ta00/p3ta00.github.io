---
layout: default
---
<article class="writeup">
  <header class="writeup-header">
    <h1 class="section-header glitch">{{ page.title }}</h1>
    <div class="writeup-meta">
      <span class="writeup-tag">{{ page.platform }}</span>
      {% if page.difficulty %}
      <span class="writeup-difficulty difficulty-{{ page.difficulty | downcase }}">{{ page.difficulty }}</span>
      {% endif %}
      {% if page.date %}
      <span>{{ page.date | date: "%Y-%m-%d" }}</span>
      {% endif %}
      {% if page.os %}
      <span>OS: {{ page.os }}</span>
      {% endif %}
      {% if page.points %}
      <span>{{ page.points }} pts</span>
      {% endif %}
    </div>
  </header>

  {% if page.active and page.hash_required %}
  <div id="locked-section" class="locked-content">
    <div class="lock-icon">[LOCKED]</div>
    <p>This writeup is for an <strong>active</strong> machine.</p>
    <p style="color: var(--cyan);">Enter root.txt to unlock:</p>
    <br>
    <input type="text" id="hash-input" class="hash-input" placeholder="Enter root.txt hash...">
    <button id="unlock-btn" class="unlock-btn">Submit</button>
    <div id="result-message" style="margin-top: 15px; min-height: 30px;"></div>
  </div>

  <div id="unlocked-content" class="post-content" style="display: none;">
    {{ content }}
  </div>

  <script>
    const correctPassword = "{{ page.unlock_password }}";

    async function sleep(ms) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }

    async function typeMessage(container, text, className) {
      container.innerHTML = '';
      for (let i = 0; i < text.length; i++) {
        const span = document.createElement('span');
        span.className = className;
        span.style.animationDelay = `${i * 0.1}s`;
        span.textContent = text[i];
        container.appendChild(span);
        await sleep(60);
      }
    }

    async function unlockContent() {
      const input = document.getElementById('hash-input');
      const btn = document.getElementById('unlock-btn');
      const result = document.getElementById('result-message');
      const attempt = input.value.trim();

      input.disabled = true;
      btn.disabled = true;

      if (attempt === correctPassword) {
        await typeMessage(result, 'You are a man that walks among the Gods', 'pulse-rainbow');
        await sleep(1500);
        result.innerHTML += '<br><span style="color: var(--green);">[+] ACCESS GRANTED</span>';
        await sleep(1000);
        document.getElementById('locked-section').style.display = 'none';
        document.getElementById('unlocked-content').style.display = 'block';
        sessionStorage.setItem('unlocked_{{ page.slug }}', 'true');
      } else {
        await typeMessage(result, 'Alexis stop being a noob!', 'pulse-rainbow');
        await sleep(1500);
        result.innerHTML += '<br><span style="color: var(--red);">[-] Try harder...</span>';
        await sleep(500);
        input.disabled = false;
        btn.disabled = false;
        input.value = '';
        input.focus();
      }
    }

    // Check if already unlocked in this session
    if (sessionStorage.getItem('unlocked_{{ page.slug }}') === 'true') {
      document.getElementById('locked-section').style.display = 'none';
      document.getElementById('unlocked-content').style.display = 'block';
    }

    document.getElementById('unlock-btn').addEventListener('click', unlockContent);
    document.getElementById('hash-input').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') unlockContent();
    });
  </script>

  {% else %}
  <div class="post-content">
    {{ content }}
  </div>
  {% endif %}

  <div class="writeup-nav" style="margin-top: 40px; padding-top: 20px; border-top: 1px dashed var(--terminal-black);">
    <a href="{{ '/ctf/' | relative_url }}" style="color: var(--cyan); text-decoration: none;">
      <span style="color: var(--green);">&lt;</span> cd ../ctf
    </a>
  </div>
</article>
